<div class="navbar-home inFront">
    <%# <button class="buttontext"></button> %>
    <%= link_to "üëà", :back %>
    <button class="floatright buttontext">‚ù§Ô∏è</button>
    <button class="floatright buttontext">üì§</button>
</div>

<div id="wrapper">
  <div id="a" class="panels">
    <div class="function-imagemap">
      <div class="imagemap-button-container">
        <div class="tab">
          <button class="tablinks" onclick="openCity(event, 'map')">pictures</button>
          <button class="tablinks" onclick="openCity(event, 'picure')">view map</button>
        </div>
      </div>
      <!-- Tab content -->
      <div id="map" class="tabcontent">
      <div class="header-image-container" >
        <div class="header-image" id="hideimage">
          <% if @event.photo.key %>
            <%= cl_image_tag @event.photo.key, class: 'event-image-OFF header-image', data: { "tabs-target" => "hideable" } %>
          <% end %>
        </div>
      </div>
    </div>
    <div id="picure" class="tabcontent">
      <div class="map-container">
        <div style="width: 100%; height: 600px; margin: 0 auto;"
          data-controller="map"
          data-tabs-target="hideable"
          data-map-markers-value="<%= @markers.to_json %>"
          data-map-api-key-value="<%= ENV['MAPBOX_API_KEY'] %>">
        </div>
      </div>
    </div>
<script>
  function openCity(evt, cityName) {
    // Declare all variables
    var i, tabcontent, tablinks;

    // Get all elements with class="tabcontent" and hide them
    tabcontent = document.getElementsByClassName("tabcontent");
    for (i = 0; i < tabcontent.length; i++) {
      tabcontent[i].style.display = "none";
    }

    // Get all elements with class="tablinks" and remove the class "active"
    tablinks = document.getElementsByClassName("tablinks");
    for (i = 0; i < tablinks.length; i++) {
      tablinks[i].className = tablinks[i].className.replace(" active", "");
    }

    // Show the current tab, and add an "active" class to the button that opened the tab
    document.getElementById(cityName).style.display = "block";
    evt.currentTarget.className += " active";
  }
</script>


        <div class="header-footer-links">
          <%# <button class="buttontext"></button> %>
          <% if policy(@event).edit? %>
            <%= link_to "", edit_event_path(@event), class: "fa-solid fa-pen header-footer-button" %>
          <% end %>
          <% if policy(@event).destroy? %>
            <%= link_to "", @event, method: :delete, data: { confirm: 'Are you sure?' }, class: "fa-solid fa-trash header-footer-button" %>
          <% end %>
          <%# <button class="fa-solid fa-pen header-footer-button"></button> %>
          <%# <button class="fa-solid fa-trash header-footer-button"></button> %>
        </div>
        <%# <div class="header-map-container">
          <div class="header-map">map</div>
        </div> %>
      </div>
    </div>
    <div id="c" class="panels">
      <div class="section-header-text">
        <div class="header-text-container">
            <div class="header-title-container">
              <p class="display-1" id="header-title"> <%= @event.title %>
              </p>
            </div>
            <div class="header-description-container">
              <p class="display-2" id="header-description"> Lorem ipsum dolor sit amet, consectetur adipiscing elit.
              </p>
            </div>
            <div class="header-address-container">
              <p class="display-3" id="header-address"> <%= @event.beach.address %>
              </p>
            </div>
            <div class="header-attendees-container">
              <div class="attendees-avatar-container">
                <% @event.user_events.each do |attendance| %>
                  <% if attendance.user.profile.photo.key %>
                    <%= cl_image_tag attendance.user.profile.photo.key , class:"attendees-avatar avatar-OFF" %>
                  <% else %>
                    <%= image_tag "default-photo.webp", class:"attendees-avatar avatar-OFF" %>
                  <% end %>
                <% end %>
              </div>
              <div class="attendees-counter-container">
                <p class="header-info"><%= @event.user_events.count %>
                  <% if @event.user_events.count == 1 %>
                    <%= "person attending" %>
                  <% else %>
                    <%= "people attending" %>
                  <% end %>
                </p>
              </div>
            </div>
              <div class="event-description">
                <%# end of user_events loop %>
                <%# end of user_events loop %>
                <% if UserEvent.where(event: @event, user: current_user).empty?%>
                  <%= link_to "Attend", event_user_events_path(@event), data: {turbo_method: :post, turbo_confirm: "Are ready to parteyyyyyyyyyyyyyy?"} %>
                <% end %>
                <% unless @event.user_events.empty? %>
                  <% user_event = UserEvent.find_by(user: current_user, event: @event) %>
                  <%= link_to "Cancel attend", user_event_path(user_event), data: {turbo_method: :delete, turbo_confirm: "Are you sure?"} if user_event %>
                <% end %>
                <div class="event-description">
                </div>
                <div class="actions">
                <%# comment out %>
                  <%# if policy(@event).edit? %>
                    <%# <%=# link_to "Edit", edit_event_path(@event), class: 'btn btn-primary mt-2' %>
                  <%# end %>
                  <%# if policy(@event).destroy? %>
                    <%# <%=# button_to "Delete", @event, method: :delete, data: { confirm: 'Are you sure?' }, class: 'btn btn-primary mt-2' %>
                  <% #end %>
                <%# comment out %>
              </div>
        </div>
      </div>
    </div>
</div>
